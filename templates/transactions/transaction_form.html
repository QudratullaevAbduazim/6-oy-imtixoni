{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card shadow-lg border-0 rounded-4 animate-slideUp">
            <div class="card-body p-4 p-md-5">
                <div class="text-center mb-4">
                    <div class="bg-{% if kind == 'in' %}success{% else %}danger{% endif %} bg-opacity-10 d-inline-block p-3 rounded-circle mb-3">
                        <i class="fas fa-{% if kind == 'in' %}arrow-down{% else %}arrow-up{% endif %} fa-2x text-{% if kind == 'in' %}success{% else %}danger{% endif %}"></i>
                    </div>
                    <h2 class="fw-bold">{% if kind == 'in' %}Kirim{% else %}Chiqim{% endif %} qo'shish</h2>
                </div>

                <form method="post" class="needs-validation">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label class="form-label small fw-bold">Hisob (Hamyon)</label>
                        <select name="account" class="form-select rounded-pill" required>
                            {% for acc in accounts %}
                                <option value="{{ acc.id }}" {% if request.POST.account == acc.id|stringformat:"s" %}selected{% endif %}>
                                    {{ acc.name }} ({{ acc.balance }} {{ acc.currency }})
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Kategoriya</label>
                        <select name="category" class="form-select rounded-pill" required>
                            {% for cat in categories %}
                                <option value="{{ cat.id }}" {% if request.POST.category == cat.id|stringformat:"s" %}selected{% endif %}>
                                    {{ cat.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="row">
                        <div class="col-8">
                            <div class="mb-3">
                                <label class="form-label small fw-bold">Summa</label>
                                <input type="number" step="0.01" name="amount" 
                                       class="form-control rounded-pill" 
                                       placeholder="0.00" 
                                       value="{{ request.POST.amount }}" required>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="mb-3">
                                <label class="form-label small fw-bold">Valyuta</label>
                                <select name="currency" class="form-select rounded-pill">
                                    <option value="UZS" {% if request.POST.currency == "UZS" %}selected{% endif %}>UZS</option>
                                    <option value="USD" {% if request.POST.currency == "USD" %}selected{% endif %}>USD</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label small fw-bold">Izoh</label>
                        <textarea name="comment" class="form-control rounded-4" rows="2" placeholder="Ixtiyoriy...">{{ request.POST.comment }}</textarea>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-{% if kind == 'in' %}success{% else %}danger{% endif %} btn-lg rounded-pill shadow-sm fw-bold">
                            Saqlash
                        </button>
                        <a href="{% url 'dashboard' %}" class="btn btn-link text-muted text-decoration-none small">Bekor qilish</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    .form-control, .form-select {
        padding: 0.75rem 1.2rem;
        background-color: #f8f9fa;
        border: 1.5px solid #eee;
        transition: all 0.3s ease;
    }
    .form-control:focus, .form-select:focus {
        background-color: #fff;
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.1);
    }
    .animate-slideUp {
        animation: slideUp 0.5s ease-out;
    }
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
{% endblock %}